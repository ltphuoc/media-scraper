config:
  target: 'http://localhost:4000'
  phases:
    - duration: 5
      arrivalRate: 1
      name: 'Smoke test'
  defaults:
    headers:
      Content-Type: 'application/json'
      Authorization: 'Basic YWRtaW46YWRtaW4='
  plugins:
    expect: {}

scenarios:
  - name: 'Smoke - health check'
    flow:
      - get:
          url: '/health'
          expect:
            - statusCode: 200

  - name: 'Smoke - scrape single URL'
    flow:
      - post:
          url: '/api/scrape'
          json:
            urls: ['https://react.dev']
          expect:
            - statusCode: 200

  - name: 'Smoke - get medias'
    flow:
      - get:
          url: '/api/media?page=1&limit=20'
          expect:
            - statusCode: 200
